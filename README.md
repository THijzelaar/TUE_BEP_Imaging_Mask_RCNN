# TUE_BEP_Imaging_Mask_RCNN
Bachelor End Project on the topic of improving the performance of Mask R-CNN on nuclei instance segmentation. See paper for in depth explanations of the methods used.

The data generation folder contains all files for the application of the Distance Maps and Hematoxylin stains.
The distance_map_trainer.py contains the training method of the U-net model which can generate predicted distance maps.
The ground truth distance map used by this file are generated by Distance_map_from_json.py. This file takes in annotations and converts them to distance maps.
The file image_generator.py converts standard png images to the 4-channel images including H-stains and distance maps in the alpha channel.
normalizeStaining.py is the file used to extract the Hematoxylin stains. (Macenko et al., 2009, https://github.com/schaugf/HEnorm_python/blob/master/normalizeStaining.py)


The Mask R-CNN folder is for the training of the model. The adaptations required to convert the model from three channels to four are present in the file 02_1_train_RLE_base.py.
Both folders use separate environments, mainly due to some incompatibilites between TensorFlow and pyTorch.
The requirements of both environments can be found in their respective folders.
